<!DOCTYPE html>
<html>
<head lang="CN">
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width,minimum-scale=1.0,maximum-scale=1.0,user-scalable=no">
  <title>Slebee</title>

  <link href="//cdn.bootcss.com/animate.css/3.4.0/animate.min.css" rel="stylesheet">
  <link href="/blog/styles/slebee.css" rel="stylesheet">
  <script src="/blog/js/common.js"></script>
</head>
<body>
<header class="jumbotron rubberBand animated">
  <div class="container text-center">
    <div class="avatar"></div>
    <h1 class="hello">SLEBEE</h1>
    <p class="introduction">欢迎来到我的博客</p>
  </div>
</header>
<!-- row start -->
<div class="container main">
    <div class="h-wrap">
      <div class="line"></div>
      <h1 class="text-left list-h1">Article</h1>
    </div>
    <div class="article-list-wrap" id="listWrap">
      Loading……
    </div>
</div>
<section class="article-detail-wrap" id="iframeWrap">
  <iframe src="" id="iframeCon" style="width:100%;height:100%"></iframe>
</section>
<a class="close"></a>
</body>
<script>
  getArticleList();
  function getArticleList(){
    S.ajax({
      url:'/api/blog/articles',
      sccuess:function(data){
        printArticle( JSON.parse(data) );
      }
    })
  }
  function printArticle(data){
    var htmlStr = '';
    console.log(data)
    for( var i = 0;i<data.length;i++ ){
      htmlStr += '<div class="row article-list-item animated sSlideInUp" style="animation-delay: '+ i*.1 +'s;">'+
                  '<h3><a onclick="showArticle(\''+ data[i]._id +'\')">'+ data[i].title +'</a> <span class="comment-count pull-right"><span class = "cy_cmt_count" id = "sourceId::'+data[i]._id+'" ></span></span></h3>'+
                  '<p class="content">' + data[i].summary + '</p>'+
                  '<p class="parm"><small class="pull-left">Created By '+ data[i].creator.fullName +'</small><small class="pull-right" >'+ data[i].created +'</small></p>'+
                  '</div>'
    }
    S.getEle('#listWrap').html(htmlStr);
    var s = document.createElement('script');
    s.setAttribute('id','cy_cmt_num');
    s.setAttribute('src','http://changyan.sohu.com/upload/plugins/plugins.list.count.js?clientId=cyrTELar4');
    console.log(document.body)
    document.body.appendChild(s);
  }
  function showArticle(id){
    S.getEle('#iframeCon').eq(0).setAttribute('src','/articles/'+id);
    S.getEle('#iframeWrap').eq(0).setAttribute('style',"z-index:10;opacity:1");
    window.location.hash='aa'
  }
  window.onhashchange = function(){
    alert(1)
  }
</script>
</html>